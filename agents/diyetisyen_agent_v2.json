{
  "owner": "test",
  "agentId": "diyetisyen_agent_v2",
  "agentName": "SmartDiet AI Proaktif Diyet AsistanÄ±",
  "version": "2.0",
  "systemPrompt": "Sen bir profesyonel ve proaktif AI diyetisyen asistanÄ±sÄ±n. KullanÄ±cÄ±larÄ±n saÄŸlÄ±k durumlarÄ±na, hedeflerine ve yaÅŸam tarzlarÄ±na uygun kiÅŸiselleÅŸtirilmiÅŸ beslenme programlarÄ± oluÅŸturursun. Her kullanÄ±cÄ± iÃ§in detaylÄ± bir profil oluÅŸturup, bilimsel verilere dayalÄ± beslenme planlarÄ± hazÄ±rlarsÄ±n. ProgramlarÄ± dÃ¼zenli olarak takip eder, kullanÄ±cÄ± geri bildirimlerini ve gÃ¼nlÃ¼k kayÄ±tlarÄ±nÄ± deÄŸerlendirir ve gerektiÄŸinde planlarÄ± gÃ¼ncellersin. TÃ¼m verileri organize bir ÅŸekilde veritabanÄ±na kaydeder ve kullanÄ±cÄ±larÄ±n ilerlemesini gÃ¶rsel raporlarla sunarsun.\n\nğŸ¤– **TELEGRAM ENTEGRASYONUNDAKÄ° YETKÄ°LERÄ°N:**\n- KullanÄ±cÄ±larÄ±n Telegram hesaplarÄ±na otomatik bildirimler gÃ¶nderebilirsin\n- GÃ¼nlÃ¼k beslenme hatÄ±rlatmalarÄ±, motivasyon mesajlarÄ± ve raporlarÄ± Telegram'a iletebilirsin\n- ZamanlanmÄ±ÅŸ mesajlarla kullanÄ±cÄ±larÄ± dÃ¼zenli takip edebilirsin\n- Telegram Ã¼zerinden aldÄ±ÄŸÄ±n kullanÄ±cÄ± verilerini iÅŸleyebilir ve yanÄ±tlayabilirsin\n- KullanÄ±cÄ± izni ile Telegram'a kiÅŸiselleÅŸtirilmiÅŸ beslenme planlarÄ± ve listeler gÃ¶nderebilirsin\n\nğŸ”§ **TOOL KULLANIM YÃ–NERGELERÄ°:**\n- KullanÄ±cÄ± Telegram mesajÄ± istediÄŸinde **telegram_gonderici** tool'unu kullan\n- Veri kaydetmek/okumak iÃ§in **veritabani_islemleri** tool'unu kullan\n- Tool Ã§aÄŸÄ±rma formatÄ±: `[TOOL_CALL: tool_id, {\"param1\": \"value1\", \"param2\": \"value2\"}]`\n- Telegram mesajÄ± Ã¶rneÄŸi: `[TOOL_CALL: telegram_gonderici, {\"message\": \"ğŸ GÃ¼nlÃ¼k beslenme hatÄ±rlatmanÄ±z!\"}]`\n\nKullanÄ±cÄ± Telegram entegrasyonunu istediÄŸinde, ona platform Ã¼zerinden Telegram hesabÄ±nÄ± baÄŸlamasÄ±nÄ± sÃ¶yle ve ardÄ±ndan **gerÃ§ekten** otomatik bildirimler gÃ¶nder. Daima profesyonel, motive edici ve destekleyici bir dil kullan. TÄ±bbi teÅŸhis koyma, sadece genel beslenme Ã¶nerileri sun.\n\nÃ–NEMLÄ° FORMAT KURALLARI:\n1. **TABLOLAR KULLAN**: Besin bilgileri, kalori hesaplamalarÄ±, program karÅŸÄ±laÅŸtÄ±rmalarÄ± iÃ§in MUTLAKA tablo formatÄ± kullan.\n2. **VÄ°ZUAL DÄ°YAGRAMLAR**: SÃ¼reÃ§ akÄ±ÅŸlarÄ±, beslenme dÃ¶ngÃ¼leri iÃ§in Mermaid diyagramlarÄ± kullan (mermaid kodlarÄ±nÄ±n doÄŸru olduÄŸundan emin ol).\n3. **MARKDOWN**: BaÅŸlÄ±klar iÃ§in #, listeler iÃ§in -, tablolar iÃ§in | kullan.\n4. **TELEGRAM MESAJLARI**: Telegram'a gÃ¶nderilecek iÃ§erikleri kopyalanabilir formatta hazÄ±rla ve gerÃ§ekten gÃ¶nder.",
  "llmConfig": {
    "provider": "deepseek",
    "model": "deepseek-chat"
  },
  "dataSchema": {
    "collectionName": "diyetisyen_kullanici_verileri",
    "schema": {
      "type": "object",
      "properties": {
        "kullanici_id": {
          "type": "string",
          "description": "Benzersiz kullanÄ±cÄ± tanÄ±mlayÄ±cÄ± (Ã–rn: telegram_user_id)"
        },
        "temel_bilgiler": {
          "type": "object",
          "properties": {
            "yas": {
              "type": "number"
            },
            "boy_cm": {
              "type": "number"
            },
            "baslangic_kilo_kg": {
              "type": "number"
            },
            "cinsiyet": {
              "type": "string",
              "enum": [
                "erkek",
                "kadin",
                "diger"
              ]
            },
            "aktivite_seviyesi": {
              "type": "string",
              "enum": [
                "sedanter",
                "hafif",
                "orta",
                "aktif",
                "cok_aktif"
              ]
            }
          },
          "required": [
            "yas",
            "boy_cm",
            "baslangic_kilo_kg",
            "cinsiyet",
            "aktivite_seviyesi"
          ]
        },
        "saglik_bilgileri": {
          "type": "object",
          "properties": {
            "alerjiler": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "kronik_rahatsizliklar": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "kullanilan_ilaclar": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "hedefler": {
          "type": "object",
          "properties": {
            "ana_hedef": {
              "type": "string",
              "enum": [
                "kilo_verme",
                "kilo_alma",
                "kas_kazanma",
                "koruma",
                "dengeli_beslenme"
              ]
            },
            "hedef_kilo_kg": {
              "type": "number"
            },
            "haftalik_hedef_kg": {
              "type": "number"
            },
            "beslenme_tercihleri": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "required": [
            "ana_hedef"
          ]
        },
        "diyet_planlari": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "plan_id": {
                "type": "string"
              },
              "tarih": {
                "type": "string",
                "format": "date"
              },
              "hedef_gunluk_kalori": {
                "type": "number"
              },
              "aktif_mi": {
                "type": "boolean",
                "default": true
              },
              "ogunler": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "ogun_adi": {
                      "type": "string"
                    },
                    "besinler": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "haftalik_takip_verileri": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "tarih": {
                "type": "string",
                "format": "date"
              },
              "kilo_kg": {
                "type": "number"
              },
              "vucut_olcumleri_cm": {
                "type": "object",
                "properties": {
                  "bel": {
                    "type": "number"
                  },
                  "kalca": {
                    "type": "number"
                  }
                }
              },
              "degerlendirme": {
                "type": "string"
              }
            }
          }
        },
        "gunluk_kayitlar": {
          "type": "array",
          "description": "KullanÄ±cÄ±nÄ±n her gÃ¼n girdiÄŸi gerÃ§ek tÃ¼ketim ve aktivite verileri",
          "items": {
            "type": "object",
            "properties": {
              "tarih": {
                "type": "string",
                "format": "date"
              },
              "uyulan_plan_id": {
                "type": "string"
              },
              "gerceklesen_kalori": {
                "type": "number"
              },
              "su_tuketimi_lt": {
                "type": "number"
              },
              "yapilan_egzersiz": {
                "type": "string",
                "description": "Ã–rn: 30 dakika tempolu yÃ¼rÃ¼yÃ¼ÅŸ"
              },
              "uyku_suresi_saat": {
                "type": "number"
              },
              "notlar_ve_hissiyat": {
                "type": "string",
                "description": "KullanÄ±cÄ±nÄ±n o gÃ¼nkÃ¼ ruh hali, zorluklarÄ± vb."
              },
              "ogun_kayitlari": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "ogun_adi": {
                      "type": "string"
                    },
                    "tuketilen_besinler": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "required": [
        "kullanici_id",
        "temel_bilgiler",
        "hedefler"
      ]
    }
  },
  "tools": [
    {
      "toolId": "veritabani_islemleri",
      "type": "DATABASE",
      "name": "VeritabanÄ± Ä°ÅŸlemleri",
      "description": "MongoDB veritabanÄ±nda koleksiyon oluÅŸturma, veri ekleme (insert_document), bulma (find_documents), gÃ¼ncelleme (update_document), silme (delete_document), sayma (count_documents) ve gruplama/analiz (aggregate) gibi Ã§eÅŸitli iÅŸlemleri yÃ¶netmek iÃ§in kullanÄ±lÄ±r."
    },
    {
      "toolId": "telegram_gonderici",
      "type": "TELEGRAM",
      "name": "Telegram Mesaj GÃ¶nderici",
      "description": "Belirtilen kullanÄ±cÄ±ya (chat_id kullanarak) Telegram Ã¼zerinden proaktif mesajlar gÃ¶ndermek iÃ§in kullanÄ±lÄ±r."
    }
  ],
  "workflows": [
    {
      "workflowId": "yeni_kullanici_kayit",
      "description": "Yeni kullanÄ±cÄ± iÃ§in profil oluÅŸturma ve baÅŸlangÄ±Ã§ diyet planÄ± hazÄ±rlama",
      "trigger": "yeni_kullanici",
      "nodes": [
        {
          "nodeId": "1",
          "type": "llm_prompt",
          "prompt": "KullanÄ±cÄ±dan temel bilgilerini al: yaÅŸ, boy, kilo, cinsiyet, aktivite seviyesi",
          "output_variable": "temel_bilgiler",
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "2",
          "type": "llm_prompt",
          "prompt": "KullanÄ±cÄ±nÄ±n saÄŸlÄ±k durumunu Ã¶ÄŸren: alerjiler, kronik hastalÄ±klar, kullandÄ±ÄŸÄ± ilaÃ§lar",
          "output_variable": "saglik_bilgileri",
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "3",
          "type": "llm_prompt",
          "prompt": "KullanÄ±cÄ±nÄ±n hedeflerini belirle: kilo verme/alma, kas kazanma, beslenme tercihleri",
          "output_variable": "hedefler",
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "4",
          "type": "tool_call",
          "output_variable": "kayit_sonucu",
          "toolId": "veritabani_islemleri",
          "params": {
            "operation": "insert_document",
            "collection_name": "diyetisyen_kullanici_verileri",
            "document": {
              "kullanici_id": "$user_id",
              "temel_bilgiler": "$temel_bilgiler",
              "saglik_bilgileri": "$saglik_bilgileri",
              "hedefler": "$hedefler",
              "olusturma_tarihi": "$current_date"
            }
          },
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "5",
          "type": "llm_prompt",
          "prompt": "Toplanan bilgilere gÃ¶re kiÅŸiselleÅŸtirilmiÅŸ baÅŸlangÄ±Ã§ diyet planÄ± oluÅŸtur",
          "output_variable": "baslangic_plani",
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "6",
          "type": "send_response",
          "message": "Harika! Profilin baÅŸarÄ±yla oluÅŸturuldu. Ä°ÅŸte sana Ã¶zel hazÄ±rladÄ±ÄŸÄ±m baÅŸlangÄ±Ã§ planÄ±n: $baslangic_plani. Unutma, her akÅŸam sana gÃ¼nÃ¼nÃ¼n nasÄ±l geÃ§tiÄŸini soracaÄŸÄ±m. Birlikte baÅŸaracaÄŸÄ±z! ğŸ’ª",
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        }
      ]
    },
    {
      "workflowId": "gunluk_kontrol_ve_kayit",
      "description": "Her gÃ¼n kullanÄ±cÄ±dan beslenme ve aktivite bilgilerini alÄ±p veritabanÄ±na kaydeder ve geri bildirimde bulunur.",
      "trigger": "schedule:gunluk_takip_mesaji",
      "nodes": [
        {
          "nodeId": "1",
          "type": "tool_call",
          "output_variable": "mesaj_gonderim_sonucu",
          "toolId": "telegram_gonderici",
          "params": {
            "chat_id": "$user_id",
            "message": "Merhaba! ğŸ‘‹ BugÃ¼n gÃ¼nÃ¼n nasÄ±l geÃ§ti? Neler yediÄŸini, ne kadar su iÃ§tiÄŸini ve hangi egzersizleri yaptÄ±ÄŸÄ±nÄ± kÄ±saca anlatÄ±r mÄ±sÄ±n?"
          },
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "2",
          "type": "llm_prompt",
          "prompt": "KullanÄ±cÄ±nÄ±n verdiÄŸi ÅŸu cevabÄ± analiz et ve yapÄ±landÄ±rÄ±lmÄ±ÅŸ JSON formatÄ±na dÃ¶nÃ¼ÅŸtÃ¼r (gerceklesen_kalori, su_tuketimi_lt, yapilan_egzersiz, notlar_ve_hissiyat, ogun_kayitlari): $user_input",
          "output_variable": "gunluk_veri_json",
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "3",
          "type": "tool_call",
          "output_variable": "kayit_guncelleme_sonucu",
          "toolId": "veritabani_islemleri",
          "params": {
            "operation": "update_document",
            "collection_name": "diyetisyen_kullanici_verileri",
            "query": {
              "kullanici_id": "$user_id"
            },
            "update": {
              "$push": {
                "gunluk_kayitlar": "$gunluk_veri_json"
              }
            }
          },
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "4",
          "type": "llm_prompt",
          "prompt": "KullanÄ±cÄ±nÄ±n bugÃ¼nkÃ¼ verilerine ($gunluk_veri_json) ve hedeflerine bakarak ona motive edici ve kÄ±sa bir geri bildirim hazÄ±rla.",
          "output_variable": "gunluk_geri_bildirim",
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "5",
          "type": "tool_call",
          "output_variable": "geribildirim_gonderme_sonucu",
          "toolId": "telegram_gonderici",
          "params": {
            "chat_id": "$user_id",
            "message": "$gunluk_geri_bildirim"
          },
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        }
      ]
    },
    {
      "workflowId": "haftalik_takip",
      "description": "KullanÄ±cÄ±nÄ±n haftalÄ±k ilerlemesini deÄŸerlendirme ve plan gÃ¼ncelleme",
      "trigger": "schedule:haftalik_kontrol",
      "nodes": [
        {
          "nodeId": "1",
          "type": "tool_call",
          "output_variable": "haftalik_analiz",
          "toolId": "veritabani_islemleri",
          "params": {
            "operation": "aggregate",
            "collection_name": "diyetisyen_kullanici_verileri",
            "pipeline": [
              {
                "$match": {
                  "kullanici_id": "$user_id"
                }
              },
              {
                "$unwind": "$gunluk_kayitlar"
              },
              {
                "$group": {
                  "_id": "$kullanici_id",
                  "ortalama_kalori": {
                    "$avg": "$gunluk_kayitlar.gerceklesen_kalori"
                  },
                  "toplam_egzersiz_sayisi": {
                    "$sum": 1
                  }
                }
              }
            ]
          },
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "2",
          "type": "llm_prompt",
          "prompt": "KullanÄ±cÄ±dan gÃ¼ncel kilosunu ve bel Ã§evresi Ã¶lÃ§Ã¼sÃ¼nÃ¼ iste.",
          "output_variable": "guncel_olcumler",
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "3",
          "type": "llm_prompt",
          "prompt": "KullanÄ±cÄ±nÄ±n bu haftaki ortalama kalori alÄ±mÄ±nÄ± ($haftalik_analiz), gÃ¼ncel Ã¶lÃ§Ã¼mlerini ($guncel_olcumler) ve hedeflerini karÅŸÄ±laÅŸtÄ±rarak detaylÄ± bir haftalÄ±k ilerleme raporu oluÅŸtur. (Tablo ve Mermaid kullan)",
          "output_variable": "ilerleme_raporu",
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "4",
          "type": "llm_prompt",
          "prompt": "Bu rapora gÃ¶re, gerekirse diyet planÄ±nda kÃ¼Ã§Ã¼k deÄŸiÅŸiklikler Ã¶ner.",
          "output_variable": "guncel_oneri",
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "5",
          "type": "send_response",
          "message": "Ä°ÅŸte bu haftaki ilerleme raporun ve yeni Ã¶nerilerin:\n\n$ilerleme_raporu\n\n**Ã–neriler:**\n$guncel_oneri",
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        }
      ]
    },
    {
      "workflowId": "gunluk_menu_onerisi",
      "description": "Her sabah kullanÄ±cÄ±ya motivasyon mesajÄ± ve gÃ¼nÃ¼n beslenme ipucunu gÃ¶nderir",
      "trigger": "schedule:gunluk_motivasyon_ve_ipucu",
      "nodes": [
        {
          "nodeId": "1",
          "type": "tool_call",
          "output_variable": "kullanici_profili",
          "toolId": "veritabani_islemleri",
          "params": {
            "operation": "find_documents",
            "collection_name": "diyetisyen_kullanici_verileri",
            "query": {
              "kullanici_id": "$user_id"
            }
          },
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "2",
          "type": "llm_prompt",
          "prompt": "KullanÄ±cÄ±nÄ±n profili ($kullanici_profili) ve hedeflerine gÃ¶re bugÃ¼n iÃ§in kÄ±sa bir motivasyon mesajÄ± ve pratik beslenme ipucu hazÄ±rla. Maksimum 2-3 cÃ¼mle olsun.",
          "output_variable": "gunluk_mesaj",
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        },
        {
          "nodeId": "3",
          "type": "tool_call",
          "output_variable": "mesaj_gonderim_sonucu",
          "toolId": "telegram_gonderici",
          "params": {
            "chat_id": "$user_id",
            "message": "ğŸŒ… **GÃ¼naydÄ±n!** \n\n$gunluk_mesaj\n\nBugÃ¼n de harika bir gÃ¼n olacak! ğŸ’ª"
          },
          "continue_on_error": false,
          "max_retries": 3,
          "retry_delay": 1.0,
          "timeout": 30,
          "validate_input": true,
          "sanitize_output": true
        }
      ]
    }
  ],
  "schedules": [
    {
      "scheduleId": "gunluk_takip_mesaji",
      "cron": "0 20 * * *",
      "description": "Her akÅŸam kullanÄ±cÄ±ya gÃ¼nlÃ¼k verilerini sormak iÃ§in proaktif mesaj gÃ¶nderir.",
      "workflowId": "gunluk_kontrol_ve_kayit"
    },
    {
      "scheduleId": "haftalik_kontrol_bildirimi",
      "cron": "0 10 * * 1",
      "description": "Her Pazartesi sabahÄ± kullanÄ±cÄ±ya haftalÄ±k kontrol ve Ã¶lÃ§Ã¼m zamanÄ±nÄ±n geldiÄŸini hatÄ±rlatÄ±r.",
      "workflowId": "haftalik_takip"
    },
    {
      "scheduleId": "gunluk_motivasyon_ve_ipucu",
      "cron": "0 9 * * *",
      "description": "Her sabah kullanÄ±cÄ±ya motivasyon mesajÄ± ve gÃ¼nÃ¼n beslenme ipucunu gÃ¶nderir.",
      "workflowId": "gunluk_menu_onerisi"
    }
  ],
  "public": true,
  "telegram_config": {},
  "email_config": {}
}